<div class="edit-form">
  <h2 appBigtitle>Editar Curso</h2>

  <form [formGroup]="searchForm" (ngSubmit)="onSearch()" class="form">
    <mat-form-field appearance="fill">
      <mat-label>Seleccionar Curso</mat-label>
      <mat-select formControlName="code">
        <mat-option *ngFor="let curso of courses$ | async" [value]="curso.code">
          {{ curso.name }} ({{ curso.code }})
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div class="button-container">
      <button mat-raised-button color="primary" type="submit" [disabled]="searchForm.invalid">
        Buscar
      </button>
      <button mat-raised-button color="warn" type="button" (click)="onReset()">
        Limpiar
      </button>
      <a mat-stroked-button [routerLink]="['/', routes.Cursos]">
        Volver a la lista
      </a>
    </div>
  </form>

  <hr *ngIf="selectedCourse$ | async" />

  <!-- Formulario de edición -->
  <form *ngIf="selectedCourse$ | async" [formGroup]="editForm" (ngSubmit)="onEdit()" class="form">
    <mat-form-field appearance="fill">
      <mat-label>Nombre del Curso</mat-label>
      <input matInput formControlName="name" placeholder="Nombre del curso">
      <mat-error *ngIf="editForm.get('name')?.invalid">
        {{editForm.get('name')?.hasError('required') ? 'El nombre es obligatorio' :
        editForm.get('name')?.hasError('minlength') ? 'Mínimo 3 caracteres' :
        'Máximo 50 caracteres'}}
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Código</mat-label>
      <input matInput formControlName="code" placeholder="XX000">
      <mat-error *ngIf="editForm.get('code')?.invalid">
        El código debe tener formato XX000
      </mat-error>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Créditos</mat-label>
      <input matInput type="number" formControlName="credits" min="1" max="10">
      <mat-error *ngIf="editForm.get('credits')?.invalid">
        Los créditos deben estar entre 1 y 10
      </mat-error>
    </mat-form-field>

    <div class="button-container">
      <button mat-raised-button color="primary" type="submit" [disabled]="editForm.invalid || (loading$ | async)">
        {{(loading$ | async) ? 'Guardando...' : 'Guardar Cambios'}}
      </button>
      <button mat-raised-button color="warn" type="button" (click)="onReset()">
        Cancelar
      </button>
      <a mat-stroked-button [routerLink]="['/', routes.Cursos]">
        Volver a la lista
      </a>
    </div>
  </form>
</div>